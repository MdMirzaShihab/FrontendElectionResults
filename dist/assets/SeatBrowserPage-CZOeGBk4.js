import{p as Q,j as e,c as R}from"./index-C_gzxXLR.js";import{r as c,u as E}from"./vendor-react-D5zly3OG.js";import{u as w,a as z}from"./useAutoRefresh-C5B4cXPu.js";import{c as U}from"./vendor-state-CPk78qbZ.js";import{u as J}from"./useSimulation-DNYEKk6A.js";import{g as M,b as V,f as $}from"./formatters-DXobJT5u.js";import{C as v}from"./Card-Ce4z5HAh.js";import{I as q}from"./Input-8els27y-.js";import{S as u}from"./Select-COX7ggO_.js";import{B as G}from"./Button-CcyT1Mks.js";import{B as x}from"./Badge-CX70jgsv.js";import{P as H}from"./ProgressBar-QGnkt7qF.js";import{P as K}from"./Pagination-B5CkxBoE.js";import{b as W}from"./Skeleton-BlVrmxxX.js";import{i as X,S as Y}from"./vendor-icons-B72874lV.js";import"./vendor-charts-CASEHI2m.js";const h={divisionId:null,districtId:null,seatStatus:null,searchQuery:"",page:1,sortBy:"seatNumber",sortOrder:"asc"},f=U(Q(s=>({...h,setDivision:t=>s({divisionId:t,districtId:null,page:1}),setDistrict:t=>s({districtId:t,page:1}),setSeatStatus:t=>s({seatStatus:t,page:1}),setSearchQuery:t=>s({searchQuery:t,page:1}),setPage:t=>s({page:t}),resetFilters:()=>s({...h})}),{name:"election-filters",storage:{getItem:s=>{const t=sessionStorage.getItem(s);return t?JSON.parse(t):null},setItem:(s,t)=>sessionStorage.setItem(s,JSON.stringify(t)),removeItem:s=>sessionStorage.removeItem(s)}}));function Z(){const{seats:s,seatsPagination:t,isLoading:n,error:m,fetchSeats:l}=w(),a=f(),o=c.useCallback(()=>l({divisionId:a.divisionId,districtId:a.districtId,status:a.seatStatus,searchQuery:a.searchQuery,page:a.page,sortBy:a.sortBy,sortOrder:a.sortOrder}),[l,a.divisionId,a.districtId,a.seatStatus,a.searchQuery,a.page,a.sortBy,a.sortOrder]);return z(o,{interval:3e4}),J(c.useCallback(()=>o(),[o])),c.useEffect(()=>{o()},[a.divisionId,a.districtId,a.seatStatus,a.searchQuery,a.page]),{seats:s,pagination:t,isLoading:n,error:m,refresh:o}}const ee=[{value:"",label:"All Statuses"},{value:"not_started",label:"Not Started"},{value:"in_progress",label:"In Progress"},{value:"completed",label:"Completed"}],se={not_started:"bg-red-500",in_progress:"bg-accent-500",completed:"bg-green-500"},te={not_started:"Not Started",in_progress:"In Progress",completed:"Completed"};function ae({seat:s,onClick:t}){const n=s.totalCentres>0?Math.round(s.reportedCentreCount/s.totalCentres*100):0;return e.jsxs(v,{hover:!0,onClick:t,className:"animate-fade-in",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsxs(x,{variant:"primary",size:"sm",children:["#",s.seatNumber]}),e.jsx("h3",{className:"font-display font-semibold text-olive-900 dark:text-sage-100 truncate",children:s.name})]}),e.jsxs("div",{className:"flex items-center gap-1.5 shrink-0",children:[e.jsx("span",{className:R("w-2 h-2 rounded-full shrink-0",se[s.status])}),e.jsx("span",{className:"text-xs text-olive-500 dark:text-sage-400",children:te[s.status]})]})]}),s.leadingCandidate?e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-sm text-olive-700 dark:text-sage-200 truncate",children:s.leadingCandidate.name}),e.jsx(x,{size:"sm",color:s.leadingCandidate.partyColor,className:"mt-1",children:s.leadingCandidate.partyAbbreviation})]}):e.jsx("div",{className:"mb-3",children:e.jsx("p",{className:"text-sm text-olive-400 dark:text-sage-500 italic",children:"No results yet"})}),e.jsx(H,{value:n,color:s.leadingCandidate?.partyColor,size:"sm",className:"mb-2"}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-olive-500 dark:text-sage-400",children:[e.jsxs("span",{children:[s.reportedCentreCount," of ",s.totalCentres," centres"]}),s.leadingCandidate&&e.jsxs("span",{className:"font-medium",children:[$(s.leadingCandidate.totalVotes)," votes"]})]})]})}function je(){const s=E(),{seats:t,pagination:n,isLoading:m}=Z(),{divisionId:l,districtId:a,seatStatus:o,searchQuery:S,setDivision:j,setDistrict:N,setSeatStatus:C,setSearchQuery:g,setPage:b,resetFilters:y}=f(),[I,p]=c.useState(S),d=c.useRef(null),k=V(),P=l?M(l):[],T=[{value:"",label:"All Divisions"},...k.map(r=>({value:r.id,label:r.name}))],O=[{value:"",label:"All Districts"},...P.map(r=>({value:r.id,label:r.name}))],A=c.useCallback(r=>{const i=r.target.value;p(i),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{g(i)},300)},[g]);c.useEffect(()=>()=>{d.current&&clearTimeout(d.current)},[]);function B(r){const i=r.target.value||null;j(i)}function D(r){const i=r.target.value||null;N(i)}function _(r){const i=r.target.value||null;C(i)}function F(){y(),p("")}function L(r){s(`/seats/${r}`)}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(X,{size:18,className:"text-olive-500 dark:text-sage-400"}),e.jsx("h2",{className:"font-display font-semibold text-olive-900 dark:text-sage-100",children:"Search & Filter"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3",children:[e.jsx(q,{placeholder:"Search seats...",leftIcon:Y,value:I,onChange:A}),e.jsx(u,{options:T,value:l||"",onChange:B}),e.jsx(u,{options:O,value:a||"",onChange:D,disabled:!l}),e.jsx(u,{options:ee,value:o||"",onChange:_}),e.jsx(G,{variant:"ghost",size:"sm",onClick:F,className:"self-end",children:"Reset Filters"})]})]}),e.jsxs("p",{className:"text-sm text-olive-600 dark:text-sage-300",children:[e.jsx("span",{className:"font-semibold",children:n.total})," seats found"]}),m&&t.length===0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from({length:6}).map((r,i)=>e.jsx(W,{},i))}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(r=>e.jsx(ae,{seat:r,onClick:()=>L(r.id)},r.id))}),t.length===0&&!m&&e.jsxs("div",{className:"text-center py-12 text-olive-500 dark:text-sage-400",children:[e.jsx("p",{className:"text-lg font-display",children:"No seats found"}),e.jsx("p",{className:"text-sm mt-1",children:"Try adjusting your search or filters."})]}),e.jsx("div",{className:"pt-2",children:e.jsx(K,{currentPage:n.page,totalPages:n.totalPages,onPageChange:b})})]})}export{je as default};
