import{j as e,c as u}from"./index-C_gzxXLR.js";import{r as m,i as N,L as x}from"./vendor-react-D5zly3OG.js";import{u as v,a as k}from"./useAutoRefresh-C5B4cXPu.js";import{u as y}from"./useSimulation-DNYEKk6A.js";import{f as h,a as j}from"./formatters-DXobJT5u.js";import{C as p,a as C,b as w,c as P}from"./Card-Ce4z5HAh.js";import{B as n}from"./Badge-CX70jgsv.js";import{P as z}from"./ProgressBar-QGnkt7qF.js";import{a as d}from"./Skeleton-BlVrmxxX.js";import{j as f,k as S,e as R,l as D,m as A}from"./vendor-icons-B72874lV.js";import"./vendor-charts-CASEHI2m.js";import"./vendor-state-CPk78qbZ.js";function B(t){const{seatDetail:s,seatCentres:i,isLoading:o,error:r,fetchSeatDetail:l,fetchSeatCentres:c}=v(),a=m.useCallback(async()=>{t&&await Promise.all([l(t),c(t)])},[t,l,c]);return k(a,{interval:3e4,enabled:!!t}),y(m.useCallback(()=>{t&&a()},[t,a])),{seatDetail:s,seatCentres:i,isLoading:o,error:r,refresh:a}}function L({centre:t,candidates:s}){const[i,o]=m.useState(!1);return e.jsxs("div",{className:"border border-sage-200 dark:border-sage-800 rounded-xl overflow-hidden",children:[e.jsxs("button",{onClick:()=>o(!i),className:u("w-full flex items-center justify-between px-4 py-3 text-left","hover:bg-sage-50 dark:hover:bg-sage-900/50 transition-colors duration-200"),children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("span",{className:"font-medium text-sm text-olive-800 dark:text-sage-200 truncate",children:t.name}),e.jsx(n,{size:"sm",variant:t.isReported?"success":"default",children:t.isReported?"Reported":"Pending"})]}),i?e.jsx(D,{size:16,className:"shrink-0 text-olive-400 dark:text-sage-500"}):e.jsx(A,{size:16,className:"shrink-0 text-olive-400 dark:text-sage-500"})]}),i&&t.isReported&&t.results.length>0&&e.jsx("div",{className:"border-t border-sage-200 dark:border-sage-800 px-4 py-3",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-olive-500 dark:text-sage-400 text-xs",children:[e.jsx("th",{className:"text-left pb-2 font-medium",children:"Candidate"}),e.jsx("th",{className:"text-left pb-2 font-medium",children:"Party"}),e.jsx("th",{className:"text-right pb-2 font-medium",children:"Votes"})]})}),e.jsx("tbody",{children:[...t.results].sort((r,l)=>l.votes-r.votes).map(r=>(s?.find(l=>l.id===r.candidateId),e.jsxs("tr",{className:"border-t border-sage-100 dark:border-sage-800/50",children:[e.jsx("td",{className:"py-2 text-olive-800 dark:text-sage-200",children:r.candidateName}),e.jsx("td",{className:"py-2",children:e.jsx(n,{size:"sm",color:r.partyColor,children:r.partyAbbreviation})}),e.jsx("td",{className:"py-2 text-right font-medium text-olive-800 dark:text-sage-200",children:h(r.votes)})]},r.candidateId)))})]})}),i&&!t.isReported&&e.jsx("div",{className:"border-t border-sage-200 dark:border-sage-800 px-4 py-4 text-sm text-olive-400 dark:text-sage-500 italic text-center",children:"Results not yet reported for this centre"})]})}function V(){return e.jsxs("div",{className:"space-y-6",children:[e.jsx(d,{className:"h-4 w-48 rounded-md"}),e.jsx(d,{className:"h-10 w-72 rounded-md"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{className:"h-6 w-20 rounded-full"}),e.jsx(d,{className:"h-6 w-24 rounded-full"})]}),e.jsx(d,{className:"h-4 w-full rounded-full"}),e.jsx(d,{className:"h-48 w-full rounded-2xl"}),e.jsx(d,{className:"h-32 w-full rounded-2xl"})]})}function J(){const{seatId:t}=N(),{seatDetail:s,seatCentres:i,isLoading:o}=B(t);if(o&&!s)return e.jsx(V,{});if(!s)return e.jsxs("div",{className:"text-center py-16",children:[e.jsx("p",{className:"text-lg font-display text-olive-600 dark:text-sage-300",children:"Seat not found"}),e.jsx(x,{to:"/seats",className:"text-green-600 dark:text-green-400 text-sm hover:underline mt-2 inline-block",children:"Back to seats"})]});const r=s.totalCentres>0?Math.round(s.reportedCentreCount/s.totalCentres*100):0,l=s.status==="completed"&&s.candidates.length>0?s.candidates[0]:null,c=s.candidates[0]?.partyColor;return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("nav",{className:"flex items-center gap-1.5 text-sm text-olive-500 dark:text-sage-400",children:[e.jsx(x,{to:"/",className:"hover:text-green-600 dark:hover:text-green-400 transition-colors",children:"Home"}),e.jsx(f,{size:14}),e.jsx(x,{to:"/seats",className:"hover:text-green-600 dark:hover:text-green-400 transition-colors",children:"Seats"}),e.jsx(f,{size:14}),e.jsx("span",{className:"text-olive-800 dark:text-sage-200 font-medium",children:s.name})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h1",{className:"font-display text-3xl font-bold text-olive-900 dark:text-sage-50",children:s.name}),e.jsxs(n,{variant:"primary",children:["#",s.seatNumber]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsxs(n,{variant:"info",size:"sm",children:[e.jsx(S,{size:12,className:"mr-0.5"}),s.divisionName]}),e.jsx(n,{variant:"info",size:"sm",children:s.districtName})]}),e.jsxs("div",{className:"max-w-xl",children:[e.jsx(z,{value:r,color:c,size:"lg",className:"mb-2"}),e.jsxs("p",{className:"text-sm text-olive-600 dark:text-sage-300",children:[s.reportedCentreCount," of ",s.totalCentres," ","centres reported (",r,"%)"]})]})]}),l&&e.jsx(p,{className:"border-green-300 dark:border-green-800 bg-green-50/50 dark:bg-green-950/30 shadow-[0_0_20px_-4px_rgba(0,105,85,0.15)]",padding:"lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-xl bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-400",children:e.jsx(R,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-green-600 dark:text-green-400 uppercase tracking-wide mb-0.5",children:"Winner"}),e.jsx("p",{className:"font-display text-xl font-bold text-olive-900 dark:text-sage-50",children:l.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(n,{size:"sm",color:l.partyColor,children:l.partyAbbreviation}),e.jsxs("span",{className:"text-sm text-olive-600 dark:text-sage-300",children:[h(l.totalVotes)," votes (",j(l.votePercent),")"]})]})]})]})}),e.jsxs(p,{children:[e.jsx(C,{children:e.jsx(w,{children:"Candidate Results"})}),e.jsx(P,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-olive-500 dark:text-sage-400 text-xs border-b border-sage-200 dark:border-sage-800",children:[e.jsx("th",{className:"text-left pb-3 font-medium w-8",children:"#"}),e.jsx("th",{className:"text-left pb-3 font-medium",children:"Candidate"}),e.jsx("th",{className:"text-left pb-3 font-medium",children:"Party"}),e.jsx("th",{className:"text-right pb-3 font-medium",children:"Votes"}),e.jsx("th",{className:"text-right pb-3 font-medium",children:"Share"}),e.jsx("th",{className:"text-left pb-3 font-medium pl-4 hidden md:table-cell w-40",children:"Â "})]})}),e.jsx("tbody",{children:s.candidates.map((a,g)=>{const b=g===0;return e.jsxs("tr",{className:u("border-b border-sage-100 dark:border-sage-800/50 last:border-0",b&&"bg-green-50/50 dark:bg-green-950/20"),children:[e.jsx("td",{className:"py-3 text-olive-500 dark:text-sage-400 font-medium",children:g+1}),e.jsx("td",{className:"py-3 font-medium text-olive-800 dark:text-sage-200",children:a.name}),e.jsx("td",{className:"py-3",children:e.jsx(n,{size:"sm",color:a.partyColor,children:a.partyAbbreviation})}),e.jsx("td",{className:"py-3 text-right font-medium text-olive-800 dark:text-sage-200",children:h(a.totalVotes)}),e.jsx("td",{className:"py-3 text-right text-olive-600 dark:text-sage-300",children:j(a.votePercent)}),e.jsx("td",{className:"py-3 pl-4 hidden md:table-cell",children:e.jsx("div",{className:"w-full bg-sage-200 dark:bg-sage-800 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-700",style:{width:`${a.votePercent}%`,backgroundColor:a.partyColor}})})})]},a.id)})})]})})})]}),i&&i.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"font-display text-xl font-semibold text-olive-900 dark:text-sage-100 mb-4",children:"Centre-by-Centre Breakdown"}),e.jsx("div",{className:"space-y-2",children:i.map(a=>e.jsx(L,{centre:a,candidates:s.candidates},a.id))})]})]})}export{J as default};
