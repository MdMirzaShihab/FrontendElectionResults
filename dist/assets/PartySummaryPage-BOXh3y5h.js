import{j as e,c as h}from"./index-C_gzxXLR.js";import{r as o}from"./vendor-react-D5zly3OG.js";import{u as C,a as L}from"./useAutoRefresh-C5B4cXPu.js";import{u as P}from"./useSimulation-DNYEKk6A.js";import{f as u,a as f}from"./formatters-DXobJT5u.js";import{C as g,a as v,b as p,c as b}from"./Card-Ce4z5HAh.js";import{B as w}from"./Badge-CX70jgsv.js";import{S as V,a as k}from"./Skeleton-BlVrmxxX.js";import{L as A}from"./LastUpdatedIndicator-M3ggrZ6i.js";import{A as B}from"./vendor-icons-B72874lV.js";import{R,B as T,X as W,Y as z,T as U,b as K,C as M}from"./vendor-charts-CASEHI2m.js";import"./vendor-state-CPk78qbZ.js";function O(){const{parties:t,lastUpdated:l,isLoading:n,error:r,fetchParties:d}=C(),i=o.useCallback(()=>d(),[d]);return L(i,{interval:3e4}),P(o.useCallback(()=>d(),[d])),{parties:t,lastUpdated:l,isLoading:n,error:r,refresh:i}}const D=[{key:"name",label:"Party Name"},{key:"totalVotes",label:"Votes"},{key:"voteSharePercent",label:"Vote Share %"},{key:"seatsLeading",label:"Leading"},{key:"seatsWon",label:"Won"}];function E({active:t,payload:l}){if(!t||!l||l.length===0)return null;const n=l[0].payload;return e.jsxs("div",{className:"rounded-xl bg-white dark:bg-olive-900 border border-sage-200 dark:border-sage-700 px-3 py-2 shadow-soft-lg text-sm",children:[e.jsx("p",{className:"font-semibold text-olive-800 dark:text-sage-100",children:n.name}),e.jsxs("p",{className:"text-olive-600 dark:text-sage-300",children:[f(n.voteSharePercent)," vote share"]})]})}function ee(){const{parties:t,lastUpdated:l,isLoading:n}=O(),[r,d]=o.useState("totalVotes"),[i,j]=o.useState("desc"),N=o.useMemo(()=>!t||t.length===0?[]:[...t].sort((s,a)=>{let c=s[r],x=a[r];return r==="name"?(c=c.toLowerCase(),x=x.toLowerCase(),i==="asc"?c<x?-1:1:c>x?-1:1):i==="asc"?c-x:x-c}),[t,r,i]),S=o.useMemo(()=>!t||t.length===0?[]:[...t].sort((s,a)=>a.totalVotes-s.totalVotes).slice(0,4),[t]),m=o.useMemo(()=>!t||t.length===0?[]:[...t].sort((s,a)=>a.voteSharePercent-s.voteSharePercent).map(s=>({name:s.abbreviation,voteSharePercent:s.voteSharePercent,color:s.color})),[t]);function y(s){r===s?j(i==="asc"?"desc":"asc"):(d(s),j("desc"))}return n&&t.length===0?e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:Array.from({length:4}).map((s,a)=>e.jsx(V,{},a))}),e.jsx(k,{className:"h-64 w-full rounded-2xl"}),e.jsx(k,{className:"h-48 w-full rounded-2xl"})]}):e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:S.map((s,a)=>e.jsx(g,{padding:"none",className:h("overflow-hidden animate-slide-up",a===1&&"animate-delay-100",a===2&&"animate-delay-200",a===3&&"animate-delay-300"),children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-1 shrink-0",style:{backgroundColor:s.color}}),e.jsxs("div",{className:"p-4 flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("h3",{className:"font-display font-semibold text-olive-900 dark:text-sage-100 truncate text-sm",children:s.name}),e.jsx(w,{size:"sm",color:s.color,children:s.abbreviation})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-olive-500 dark:text-sage-400 text-xs",children:"Total Votes"}),e.jsx("p",{className:"font-semibold text-olive-800 dark:text-sage-200",children:u(s.totalVotes)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-olive-500 dark:text-sage-400 text-xs",children:"Vote Share"}),e.jsx("p",{className:"font-semibold text-olive-800 dark:text-sage-200",children:f(s.voteSharePercent)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-olive-500 dark:text-sage-400 text-xs",children:"Seats Won"}),e.jsx("p",{className:"font-semibold text-olive-800 dark:text-sage-200",children:s.seatsWon})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-olive-500 dark:text-sage-400 text-xs",children:"Leading"}),e.jsx("p",{className:"font-semibold text-olive-800 dark:text-sage-200",children:s.seatsLeading})]})]})]})]})},s.partyId))}),e.jsxs(g,{children:[e.jsx(v,{children:e.jsx(p,{children:"All Parties"})}),e.jsx(b,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsx("tr",{className:"text-olive-500 dark:text-sage-400 text-xs border-b border-sage-200 dark:border-sage-800",children:D.map(s=>e.jsx("th",{className:h("pb-3 font-medium cursor-pointer select-none hover:text-olive-700 dark:hover:text-sage-200 transition-colors",s.key==="name"?"text-left":"text-right",(s.key==="seatsLeading"||s.key==="seatsWon")&&"hidden sm:table-cell"),onClick:()=>y(s.key),children:e.jsxs("span",{className:"inline-flex items-center gap-1",children:[s.label,e.jsx(B,{size:12,className:h(r===s.key?"text-green-500":"opacity-40")})]})},s.key))})}),e.jsx("tbody",{children:N.map(s=>e.jsxs("tr",{className:"border-b border-sage-100 dark:border-sage-800/50 last:border-0",children:[e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full shrink-0",style:{backgroundColor:s.color}}),e.jsx("span",{className:"font-medium text-olive-800 dark:text-sage-200",children:s.name}),e.jsxs("span",{className:"text-olive-400 dark:text-sage-500 text-xs hidden sm:inline",children:["(",s.abbreviation,")"]})]})}),e.jsx("td",{className:"py-3 text-right font-medium text-olive-800 dark:text-sage-200",children:u(s.totalVotes)}),e.jsx("td",{className:"py-3 text-right text-olive-600 dark:text-sage-300",children:f(s.voteSharePercent)}),e.jsx("td",{className:"py-3 text-right text-olive-600 dark:text-sage-300 hidden sm:table-cell",children:s.seatsLeading}),e.jsx("td",{className:"py-3 text-right font-medium text-olive-800 dark:text-sage-200 hidden sm:table-cell",children:s.seatsWon})]},s.partyId))})]})})})]}),e.jsxs(g,{children:[e.jsx(v,{children:e.jsx(p,{children:"Vote Share Distribution"})}),e.jsx(b,{children:m.length>0?e.jsx(R,{width:"100%",height:300,children:e.jsxs(T,{data:m,margin:{top:10,right:10,bottom:20,left:10},children:[e.jsx(W,{dataKey:"name",tick:{fontSize:12,fill:"#696752"},axisLine:!1,tickLine:!1}),e.jsx(z,{tick:{fontSize:12,fill:"#696752"},axisLine:!1,tickLine:!1,tickFormatter:s=>`${s}%`}),e.jsx(U,{content:e.jsx(E,{})}),e.jsx(K,{dataKey:"voteSharePercent",radius:[6,6,0,0],barSize:32,children:m.map(s=>e.jsx(M,{fill:s.color},s.name))})]})}):e.jsx("div",{className:"flex items-center justify-center h-48 text-olive-400 dark:text-sage-500",children:"No party data available"})})]}),e.jsx("div",{className:"flex justify-center pt-2",children:e.jsx(A,{lastUpdated:l})})]})}export{ee as default};
