import{j as e,c as h}from"./index-C_gzxXLR.js";import{r as l}from"./vendor-react-D5zly3OG.js";import{m as N,k as j,n as k}from"./formatters-DXobJT5u.js";import{C as b}from"./Card-Ce4z5HAh.js";import{S as g}from"./Select-COX7ggO_.js";import{B as E}from"./Badge-CX70jgsv.js";import{P as w}from"./Pagination-B5CkxBoE.js";import{a as m}from"./Skeleton-BlVrmxxX.js";import{v as S}from"./vendor-icons-B72874lV.js";import"./vendor-charts-CASEHI2m.js";import"./vendor-state-CPk78qbZ.js";function T(){const[a,t]=l.useState([]),[r,d]=l.useState({page:1,totalPages:1,total:0}),[c,u]=l.useState(!1),[o,s]=l.useState({seatId:null,action:null,page:1}),i=l.useCallback(async()=>{u(!0),await new Promise(x=>setTimeout(x,300));const n=N(o,o.page,15);t(n.logs),d({page:n.page,totalPages:n.totalPages,total:n.total}),u(!1)},[o]);l.useEffect(()=>{i()},[i]);const f=l.useCallback(n=>{s(x=>({...x,...n,page:1}))},[]),v=l.useCallback(n=>{s(x=>({...x,page:n}))},[]);return{logs:a,pagination:r,isLoading:c,filters:o,updateFilters:f,setPage:v,refresh:i}}const p=[{value:"",label:"All Actions"},{value:"CENTRE_RESULT_SUBMITTED",label:"Result Submitted"},{value:"CENTRE_RESULT_UPDATED",label:"Result Updated"},{value:"SEAT_STATUS_CHANGED",label:"Status Changed"},{value:"USER_LOGIN",label:"Login"},{value:"USER_LOGOUT",label:"Logout"},{value:"DATA_EXPORT",label:"Export"},{value:"RESULT_VERIFIED",label:"Verified"},{value:"RESULT_CORRECTION",label:"Correction"}];function A(a){return a.includes("SUBMITTED")||a.includes("VERIFIED")?"primary":a.includes("UPDATED")||a.includes("CORRECTION")||a.includes("CHANGED")?"warning":a.includes("DELETE")?"error":"info"}function C(a){const t=p.find(r=>r.value===a);return t?t.label:a.replace(/_/g," ").toLowerCase()}function L(){return e.jsx("div",{className:"divide-y divide-sage-100 dark:divide-sage-800",children:Array.from({length:8}).map((a,t)=>e.jsxs("div",{className:"flex items-center gap-4 px-5 py-3",children:[e.jsx(m,{className:"h-4 w-32 rounded-md"}),e.jsx(m,{className:"h-4 w-24 rounded-md"}),e.jsx(m,{className:"h-5 w-20 rounded-full"}),e.jsx(m,{className:"h-4 w-28 rounded-md flex-1"}),e.jsx(m,{className:"h-4 w-40 rounded-md hidden lg:block"})]},t))})}function P({text:a}){const[t,r]=l.useState(!1),d=a&&a.length>60;return a?d?e.jsx("button",{type:"button",onClick:()=>r(c=>!c),className:"text-left text-sm text-olive-600 dark:text-sage-300 hover:text-olive-800 dark:hover:text-sage-100",children:t?a:`${a.slice(0,57)}...`}):e.jsx("span",{className:"text-sm text-olive-600 dark:text-sage-300",children:a}):e.jsx("span",{className:"text-olive-300 dark:text-sage-600",children:"--"})}function V(){const{logs:a,pagination:t,isLoading:r,filters:d,updateFilters:c,setPage:u}=T(),o=l.useMemo(()=>{const s=j({page:1,limit:100}).seats;return[{value:"",label:"All Seats"},...s.map(i=>({value:i.id,label:`${i.seatNumber}. ${i.name}`}))]},[]);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"font-display font-bold text-xl text-olive-900 dark:text-sage-100",children:"Audit Logs"})}),e.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[e.jsx("div",{className:"w-full sm:w-56",children:e.jsx(g,{label:"Seat",options:o,value:d.seatId||"",onChange:s=>c({seatId:s.target.value||null}),size:"sm"})}),e.jsx("div",{className:"w-full sm:w-48",children:e.jsx(g,{label:"Action",options:p,value:d.action||"",onChange:s=>c({action:s.target.value||null}),size:"sm"})})]}),e.jsx(b,{variant:"default",padding:"none",children:r?e.jsx(L,{}):a.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 gap-3",children:[e.jsx(S,{size:32,className:"text-olive-300 dark:text-sage-600"}),e.jsx("p",{className:"text-sm text-olive-400 dark:text-sage-500",children:"No audit logs found"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hidden lg:flex items-center gap-4 px-5 py-3 border-b border-sage-200 dark:border-sage-800 bg-sage-50 dark:bg-sage-900/50 rounded-t-2xl",children:[e.jsx("span",{className:"text-xs font-medium text-olive-500 dark:text-sage-400 uppercase tracking-wider w-40",children:"Timestamp"}),e.jsx("span",{className:"text-xs font-medium text-olive-500 dark:text-sage-400 uppercase tracking-wider w-36",children:"Admin"}),e.jsx("span",{className:"text-xs font-medium text-olive-500 dark:text-sage-400 uppercase tracking-wider w-28",children:"Action"}),e.jsx("span",{className:"text-xs font-medium text-olive-500 dark:text-sage-400 uppercase tracking-wider w-36",children:"Seat"}),e.jsx("span",{className:"text-xs font-medium text-olive-500 dark:text-sage-400 uppercase tracking-wider flex-1",children:"Details"})]}),e.jsx("div",{className:"divide-y divide-sage-100 dark:divide-sage-800",children:a.map((s,i)=>e.jsxs("div",{className:h("flex flex-col lg:flex-row lg:items-center gap-2 lg:gap-4 px-5 py-3",i%2===1&&"bg-sage-50/50 dark:bg-sage-900/20"),children:[e.jsx("div",{className:"lg:w-40 shrink-0",children:e.jsx("span",{className:"text-sm text-olive-600 dark:text-sage-300 lg:text-xs",children:k(s.timestamp)})}),e.jsxs("div",{className:"lg:w-36 shrink-0",children:[e.jsx("p",{className:"text-sm font-medium text-olive-700 dark:text-sage-200",children:s.adminName||s.adminId}),e.jsx("p",{className:"text-xs text-olive-400 dark:text-sage-500",children:s.adminEmail})]}),e.jsx("div",{className:"lg:w-28 shrink-0",children:e.jsx(E,{variant:A(s.action),size:"sm",children:C(s.action)})}),e.jsxs("div",{className:"lg:w-36 shrink-0",children:[e.jsx("span",{className:"text-sm text-olive-600 dark:text-sage-300",children:s.seatName||s.seatId||"--"}),s.centreName&&e.jsx("p",{className:"text-xs text-olive-400 dark:text-sage-500",children:s.centreName})]}),e.jsx("div",{className:"hidden lg:block flex-1 min-w-0",children:e.jsx(P,{text:s.detail||s.details})})]},s.id))})]})}),t.totalPages>1&&e.jsx(w,{currentPage:t.page,totalPages:t.totalPages,onPageChange:u})]})}export{V as default};
